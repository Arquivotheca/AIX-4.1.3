static char sccsid[] = "@(#)27	1.7  src/bos/kernel/db/POWER/search.c, sysdb, bos411, 9428A410j 4/20/93 18:20:44";

/*
 * COMPONENT_NAME: (SYSDB) Kernel Debugger
 *
 * FUNCTIONS:  search
 *
 * ORIGINS: 27
 *
 * IBM CONFIDENTIAL -- (IBM Confidential Restricted when
 * combined with the aggregated modules for this product)
 *                  SOURCE MATERIALS
 * (C) COPYRIGHT International Business Machines Corp. 1988, 1993
 * All Rights Reserved
 *
 * US Government Users Restricted Rights - Use, duplication or
 * disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
 */

/*
** Functions called from outside this file
**     search(instr,opcode,exop,format,xformat,AA,LK,SA,RC,OE,retstr)
*/

/*
** search -- reads instruction table for disassembler information
**
** in:   instr       rt followon machine language instruction
**       opcode      opcode of the instruction
**       exop        extended opcode of the instruction
**       AA          bit used in B and I format instructions
**       LK          bit used in B, I, SC, and XL format instructions
**       SA          bit used in SC format instructions
**       RC          bit used in A,X,XO,XFL, and M format instructions
**       OE          bit used in XO format instructions
**
** out:  format      format of the instruction
**       xformat     print format of the instruction
**       retstr      mneumonic of the instruction
*/
typedef struct {
     unsigned long int op,ex;
     unsigned long int form,xform;
     unsigned long int A,L,S,R,O;
     char *str;
     }decrec;

static decrec dec[] = {

/*******************/
/* format   intger */
/*      D =  0     */
/*      B =  1     */
/*      I =  2     */
/*     SC =  3     */
/*      X =  4     */
/*     XL =  5     */
/*    XFX =  6     */
/*    XFL =  7     */
/*     XO =  8     */
/*      A =  9     */
/*      M = 10     */
/*     DS = 11     */
/*******************/

/* OPCD    EO     form  xform AA LK SA RC   OE                  retstr */
/* ----    --     ----  ----- -- -- -- --   --                  ------ */
 {   3,   999,      0,    3,   9, 9, 9, 9,   9,                  "ti"},
 {   7,   999,      0,    0,   9, 9, 9, 9,   9,                  "muli"},
 {   8,   999,      0,    0,   9, 9, 9, 9,   9,                  "sfi"},
 {   9,   999,      0,    0,   9, 9, 9, 9,   9,                  "dozi"},
 {  10,   999,      0,    4,   9, 9, 9, 9,   9,                  "cmpli"},

 {  11,   999,      0,    4,   9, 9, 9, 9,   9,                  "cmpi"},
 {  12,   999,      0,    0,   9, 9, 9, 9,   9,                  "ai"},
 {  13,   999,      0,    0,   9, 9, 9, 9,   9,                  "ai."},
 {  14,   999,      0,    2,   9, 9, 9, 9,   9,                  "cal"},
 {  15,   999,      0,    0,   9, 9, 9, 9,   9,                  "cau"},

 {  16,   999,      1,    9,   0, 0, 9, 9,   9,                  "bc"},
 {  16,   999,      1,    9,   1, 0, 9, 9,   9,                  "bca"},
 {  16,   999,      1,    9,   0, 1, 9, 9,   9,                  "bcl"},
 {  16,   999,      1,    9,   1, 1, 9, 9,   9,                  "bcla"},
 {  17,   999,      3,    0,   9, 0, 0, 9,   9,                  "svc"},

 {  17,   999,      3,    0,   9, 0, 1, 9,   9,                  "svca"},
 {  17,   999,      3,    0,   9, 1, 0, 9,   9,                  "svcl"},
 {  17,   999,      3,    0,   9, 1, 1, 9,   9,                  "svcla"},
 {  18,   999,      2,    9,   0, 0, 9, 9,   9,                  "b"},
 {  18,   999,      2,    9,   1, 0, 9, 9,   9,                  "ba"},

 {  18,   999,      2,    9,   0, 1, 9, 9,   9,                  "bl"},
 {  18,   999,      2,    9,   1, 1, 9, 9,   9,                  "bla"},
 {  19,     0,      5,    2,   9, 9, 9, 9,   9,                  "mcrf"},
 {  19,    16,      5,    1,   9, 0, 9, 9,   9,                  "bcr"},
 {  19,    16,      5,    1,   9, 1, 9, 9,   9,                  "bcrl"},

 {  19,    33,      5,    3,   9, 9, 9, 9,   9,                  "crnor"},
 {  19,    50,      5,    0,   9, 9, 9, 9,   9,                  "rfi"},
 {  19,    82,      5,    0,   9, 9, 9, 9,   9,                  "rfsvc"},
 {  19,   129,      5,    3,   9, 9, 9, 9,   9,                  "crandc"},
 {  19,   150,      5,    0,   9, 9, 9, 9,   9,                  "ics"},

 {  19,   193,      5,    3,   9, 9, 9, 9,   9,                  "crxor"},
 {  19,   225,      5,    3,   9, 9, 9, 9,   9,                  "crnand"},
 {  19,   257,      5,    3,   9, 9, 9, 9,   9,                  "crand"},
 {  19,   289,      5,    3,   9, 9, 9, 9,   9,                  "creqv"},
 {  19,   417,      5,    3,   9, 9, 9, 9,   9,                  "crorc"},

 {  19,   449,      5,    3,   9, 9, 9, 9,   9,                  "cror"},
 {  19,   528,      5,    1,   9, 0, 9, 9,   9,                  "bcc"},
 {  19,   528,      5,    1,   9, 1, 9, 9,   9,                  "bccl"},
 {  20,   999,     10,    1,   9, 9, 9, 0,   9,                  "rlimi"},
 {  20,   999,     10,    1,   9, 9, 9, 1,   9,                  "rlimi."},

 {  21,   999,     10,    1,   9, 9, 9, 0,   9,                  "rlinm"},
 {  21,   999,     10,    1,   9, 9, 9, 1,   9,                  "rlinm."},
 {  22,   999,     10,    0,   9, 9, 9, 0,   9,                  "rlmi"},
 {  22,   999,     10,    0,   9, 9, 9, 1,   9,                  "rlmi."},
 {  23,   999,     10,    0,   9, 9, 9, 0,   9,                  "rlnm"},

 {  23,   999,     10,    0,   9, 9, 9, 1,   9,                  "rlnm."},
 {  24,   999,      0,    1,   9, 9, 9, 9,   9,                  "oril"},
 {  25,   999,      0,    1,   9, 9, 9, 9,   9,                  "oriu"},
 {  26,   999,      0,    1,   9, 9, 9, 9,   9,                  "xoril"},
 {  27,   999,      0,    1,   9, 9, 9, 9,   9,                  "xoriu"},

 {  28,   999,      0,    1,   9, 9, 9, 9,   9,                  "andil."},
 {  29,   999,      0,    1,   9, 9, 9, 9,   9,                  "andiu."},
 {  31,     0,      4,   22,   9, 9, 9, 9,   9,                  "cmp"},
 {  31,     4,      4,   24,   9, 9, 9, 9,   9,                  "t"},
 {  31,     8,      8,    1,   9, 9, 9, 0,   0,                  "sf"},

 {  31,     8,      8,    1,   9, 9, 9, 1,   0,                  "sf."},
 {  31,     8,      8,    1,   9, 9, 9, 0,   1,                  "sfo"},
 {  31,     8,      8,    1,   9, 9, 9, 1,   1,                  "sfo."},
 {  31,    10,      8,    1,   9, 9, 9, 0,   0,                  "a"},
 {  31,    10,      8,    1,   9, 9, 9, 1,   0,                  "a."},

 {  31,    10,      8,    1,   9, 9, 9, 0,   1,                  "ao"},
 {  31,    10,      8,    1,   9, 9, 9, 1,   1,                  "ao."},
 {  31,    19,      4,    2,   9, 9, 9, 9,   9,                  "mfcr"},
 {  31,    23,      4,    7,   9, 9, 9, 9,   9,                  "lx"},
 {  31,    24,      4,    8,   9, 9, 9, 0,   9,                  "sl"},

 {  31,    24,      4,    8,   9, 9, 9, 1,   9,                  "sl."},
 {  31,    26,      4,    9,   9, 9, 9, 0,   9,                  "cntlz"},
 {  31,    26,      4,    9,   9, 9, 9, 1,   9,                  "cntlz."},
 {  31,    28,      4,    8,   9, 9, 9, 0,   9,                  "and"},
 {  31,    28,      4,    8,   9, 9, 9, 1,   9,                  "and."},

 {  31,    29,      4,    8,   9, 9, 9, 0,   9,                  "maskg"},
 {  31,    29,      4,    8,   9, 9, 9, 1,   9,                  "maskg."},
 {  31,    32,      4,   22,   9, 9, 9, 9,   9,                  "cmpl"},
 {  31,    55,      4,    7,   9, 9, 9, 9,   9,                  "lux"},
 {  31,    60,      4,    8,   9, 9, 9, 0,   9,                  "andc"},

 {  31,    60,      4,    8,   9, 9, 9, 1,   9,                  "andc."},
 {  31,    83,      4,    2,   9, 9, 9, 9,   9,                  "mfmsr"},
 {  31,    87,      4,    7,   9, 9, 9, 9,   9,                  "lbzx"},
 {  31,    104,     8,    0,   9, 9, 9, 0,   0,                  "neg"},
 {  31,    104,     8,    0,   9, 9, 9, 1,   0,                  "neg."},

 {  31,    104,     8,    0,   9, 9, 9, 0,   1,                  "nego"},
 {  31,    104,     8,    0,   9, 9, 9, 1,   1,                  "nego."},
 {  31,    107,     8,    1,   9, 9, 9, 0,   0,                  "mul"},
 {  31,    107,     8,    1,   9, 9, 9, 1,   0,                  "mul."},
 {  31,    107,     8,    1,   9, 9, 9, 0,   1,                  "mulo"},

 {  31,    107,     8,    1,   9, 9, 9, 1,   1,                  "mulo."},
 {  31,    118,     4,    6,   9, 9, 9, 9,   9,                  "clf"},
 {  31,    119,     4,    7,   9, 9, 9, 9,   9,                  "lbzux"},
 {  31,    124,     4,    8,   9, 9, 9, 0,   9,                  "nor"},
 {  31,    124,     4,    8,   9, 9, 9, 1,   9,                  "nor."},

 {  31,    136,     8,    1,   9, 9, 9, 0,   0,                  "sfe"},
 {  31,    136,     8,    1,   9, 9, 9, 1,   0,                  "sfe."},
 {  31,    136,     8,    1,   9, 9, 9, 0,   1,                  "sfeo"},
 {  31,    136,     8,    1,   9, 9, 9, 1,   1,                  "sfeo."},
 {  31,    138,     8,    1,   9, 9, 9, 0,   0,                  "ae"},

 {  31,    138,     8,    1,   9, 9, 9, 1,   0,                  "ae."},
 {  31,    138,     8,    1,   9, 9, 9, 0,   1,                  "aeo"},
 {  31,    138,     8,    1,   9, 9, 9, 1,   1,                  "aeo."},
 {  31,    144,     6,    0,   9, 9, 9, 9,   9,                  "mtcrf"},
 {  31,    146,     4,    2,   9, 9, 9, 9,   9,                  "mtmsr"},

 {  31,    151,     4,    7,   9, 9, 9, 9,   9,                  "stx"},
 {  31,    152,     4,    8,   9, 9, 9, 0,   9,                  "slq"},
 {  31,    152,     4,    8,   9, 9, 9, 1,   9,                  "slq."},
 {  31,    153,     4,    8,   9, 9, 9, 0,   9,                  "sle"},
 {  31,    153,     4,    8,   9, 9, 9, 1,   9,                  "sle."},

 {  31,    183,     4,    7,   9, 9, 9, 9,   9,                  "stux"},
 {  31,    184,     4,   11,   9, 9, 9, 0,   9,                  "sliq"},
 {  31,    184,     4,   11,   9, 9, 9, 1,   9,                  "sliq."},
 {  31,    200,     8,    0,   9, 9, 9, 0,   0,                  "sfze"},
 {  31,    200,     8,    0,   9, 9, 9, 1,   0,                  "sfze."},

 {  31,    200,     8,    0,   9, 9, 9, 0,   1,                  "sfzeo"},
 {  31,    200,     8,    0,   9, 9, 9, 1,   1,                  "sfzeo."},
 {  31,    202,     8,    0,   9, 9, 9, 0,   0,                  "aze"},
 {  31,    202,     8,    0,   9, 9, 9, 1,   0,                  "aze."},
 {  31,    202,     8,    0,   9, 9, 9, 0,   1,                  "azeo"},

 {  31,    202,     8,    0,   9, 9, 9, 1,   1,                  "azeo."},
 {  31,    210,     4,   17,   9, 9, 9, 9,   9,                  "mtsr"},
 {  31,    215,     4,    7,   9, 9, 9, 9,   9,                  "stbx"},
 {  31,    216,     4,    8,   9, 9, 9, 0,   9,                  "sllq"},
 {  31,    216,     4,    8,   9, 9, 9, 1,   9,                  "sllq."},

 {  31,    217,     4,    8,   9, 9, 9, 0,   9,                  "sleq"},
 {  31,    217,     4,    8,   9, 9, 9, 1,   9,                  "sleq."},
 {  31,    232,     8,    0,   9, 9, 9, 0,   0,                  "sfme"},
 {  31,    232,     8,    0,   9, 9, 9, 1,   0,                  "sfme."},
 {  31,    232,     8,    0,   9, 9, 9, 0,   1,                  "sfmeo"},

 {  31,    232,     8,    0,   9, 9, 9, 1,   1,                  "sfmeo."},
 {  31,    234,     8,    0,   9, 9, 9, 0,   0,                  "ame"},
 {  31,    234,     8,    0,   9, 9, 9, 1,   0,                  "ame."},
 {  31,    234,     8,    0,   9, 9, 9, 0,   1,                  "ameo"},
 {  31,    234,     8,    0,   9, 9, 9, 1,   1,                  "ameo."},

 {  31,    235,     8,    1,   9, 9, 9, 0,   0,                  "muls"},
 {  31,    235,     8,    1,   9, 9, 9, 1,   0,                  "muls."},
 {  31,    235,     8,    1,   9, 9, 9, 0,   1,                  "mulso"},
 {  31,    235,     8,    1,   9, 9, 9, 1,   1,                  "mulso."},
 {  31,    242,     4,    7,   9, 9, 9, 9,   9,                  "mtsri"},

 {  31,    247,     4,    7,   9, 9, 9, 9,   9,                  "stbux"},
 {  31,    248,     4,   11,   9, 9, 9, 0,   9,                  "slliq"},
 {  31,    248,     4,   11,   9, 9, 9, 1,   9,                  "slliq."},
 {  31,    264,     8,    1,   9, 9, 9, 0,   0,                  "doz"},
 {  31,    264,     8,    1,   9, 9, 9, 1,   0,                  "doz."},

 {  31,    264,     8,    1,   9, 9, 9, 0,   1,                  "dozo"},
 {  31,    264,     8,    1,   9, 9, 9, 1,   1,                  "dozo."},
 {  31,    266,     8,    1,   9, 9, 9, 0,   0,                  "cax"},
 {  31,    266,     8,    1,   9, 9, 9, 1,   0,                  "cax."},
 {  31,    266,     8,    1,   9, 9, 9, 0,   1,                  "caxo"},

 {  31,    266,     8,    1,   9, 9, 9, 1,   1,                  "caxo."},
 {  31,    277,     4,    7,   9, 9, 9, 0,   9,                  "lscbx"},
 {  31,    277,     4,    7,   9, 9, 9, 1,   9,                  "lscbx."},
 {  31,    279,     4,    7,   9, 9, 9, 9,   9,                  "lhzx"},
 {  31,    284,     4,    8,   9, 9, 9, 0,   9,                  "eqv"},

 {  31,    284,     4,    8,   9, 9, 9, 1,   9,                  "eqv."},
 {  31,    306,     4,    6,   9, 9, 9, 9,   9,                  "tlbi"},
 {  31,    311,     4,    7,   9, 9, 9, 9,   9,                  "lhzux"},
 {  31,    316,     4,    8,   9, 9, 9, 0,   9,                  "xor"},
 {  31,    316,     4,    8,   9, 9, 9, 1,   9,                  "xor."},

 {  31,    331,     8,    1,   9, 9, 9, 0,   0,                  "div"},
 {  31,    331,     8,    1,   9, 9, 9, 1,   0,                  "div."},
 {  31,    331,     8,    1,   9, 9, 9, 0,   1,                  "divo"},
 {  31,    331,     8,    1,   9, 9, 9, 1,   1,                  "divo."},
 {  31,    339,     4,   27,   9, 9, 9, 9,   9,                  "mfspr"},

 {  31,    343,     4,    7,   9, 9, 9, 9,   9,                  "lhax"},
 {  31,    360,     8,    0,   9, 9, 9, 0,   0,                  "abs"},
 {  31,    360,     8,    0,   9, 9, 9, 1,   0,                  "abs."},
 {  31,    360,     8,    0,   9, 9, 9, 0,   1,                  "abso"},
 {  31,    360,     8,    0,   9, 9, 9, 1,   1,                  "abso."},

 {  31,    363,     8,    1,   9, 9, 9, 0,   0,                  "divs"},
 {  31,    363,     8,    1,   9, 9, 9, 1,   0,                  "divs."},
 {  31,    363,     8,    1,   9, 9, 9, 0,   1,                  "divso"},
 {  31,    363,     8,    1,   9, 9, 9, 1,   1,                  "divso."},
 {  31,    375,     4,    7,   9, 9, 9, 9,   9,                  "lhaux"},

 {  31,    407,     4,    7,   9, 9, 9, 9,   9,                  "sthx"},
 {  31,    412,     4,    8,   9, 9, 9, 0,   9,                  "orc"},
 {  31,    412,     4,    8,   9, 9, 9, 1,   9,                  "orc."},
 {  31,    439,     4,    7,   9, 9, 9, 9,   9,                  "sthux"},
 {  31,    444,     4,    8,   9, 9, 9, 0,   9,                  "or"},

 {  31,    444,     4,    8,   9, 9, 9, 1,   9,                  "or."},
 {  31,    467,     4,    3,   9, 9, 9, 9,   9,                  "mtspr"},
 {  31,    476,     4,    8,   9, 9, 9, 0,   9,                  "nand"},
 {  31,    476,     4,    8,   9, 9, 9, 1,   9,                  "nand."},
 {  31,    488,     8,    0,   9, 9, 9, 0,   0,                  "nabs"},

 {  31,    488,     8,    0,   9, 9, 9, 1,   0,                  "nabs."},
 {  31,    488,     8,    0,   9, 9, 9, 0,   1,                  "nabso"},
 {  31,    488,     8,    0,   9, 9, 9, 1,   1,                  "nabso."},
 {  31,    502,     4,    6,   9, 9, 9, 9,   9,                  "cli"},
 {  31,    512,     4,   23,   9, 9, 9, 9,   9,                  "mcrxr"},

 {  31,    531,     4,    5,   9, 9, 9, 9,   9,                  "clcs"},
 {  31,    533,     4,    7,   9, 9, 9, 9,   9,                  "lsx"},
 {  31,    534,     4,    7,   9, 9, 9, 9,   9,                  "lbrx"},
 {  31,    536,     4,    8,   9, 9, 9, 0,   9,                  "sr"},
 {  31,    536,     4,    8,   9, 9, 9, 1,   9,                  "sr."},

 {  31,    537,     4,    8,   9, 9, 9, 0,   9,                  "rrib"},
 {  31,    537,     4,    8,   9, 9, 9, 1,   9,                  "rrib."},
 {  31,    541,     4,    8,   9, 9, 9, 0,   9,                  "maskir"},
 {  31,    541,     4,    8,   9, 9, 9, 1,   9,                 "maskir."},
 {  31,    595,     4,   18,   9, 9, 9, 9,   9,                  "mfsr"},

 {  31,    597,     4,   10,   9, 9, 9, 9,   9,                  "lsi"},
 {  31,    598,     4,    1,   9, 9, 9, 9,   9,                  "dcs"},
 {  31,    599,     4,   12,   9, 9, 9, 9,   9,                  "lfdx"},
 {  31,    627,     4,    7,   9, 9, 9, 9,   9,                  "mfsri"},
 {  31,    630,     4,    6,   9, 9, 9, 9,   9,                  "dclst"},

 {  31,    661,     4,    7,   9, 9, 9, 9,   9,                  "stsx"},
 {  31,    662,     4,    7,   9, 9, 9, 9,   9,                  "stbrx"},
 {  31,    663,     4,   12,   9, 9, 9, 9,   9,                  "stfsx"},
 {  31,    664,     4,    8,   9, 9, 9, 0,   9,                  "srq"},
 {  31,    664,     4,    8,   9, 9, 9, 1,   9,                  "srq."},

 {  31,    665,     4,    8,   9, 9, 9, 0,   9,                  "sre"},
 {  31,    665,     4,    8,   9, 9, 9, 1,   9,                  "sre."},
 {  31,    696,     4,   11,   9, 9, 9, 0,   9,                  "sriq"},
 {  31,    696,     4,   11,   9, 9, 9, 1,   9,                  "sriq."},
 {  31,    725,     4,   10,   9, 9, 9, 9,   9,                  "stsi"},

 {  31,    727,     4,   12,   9, 9, 9, 9,   9,                  "stfdx"},
 {  31,    728,     4,    8,   9, 9, 9, 0,   9,                  "srlq"},
 {  31,    728,     4,    8,   9, 9, 9, 1,   9,                  "srlq."},
 {  31,    729,     4,    8,   9, 9, 9, 0,   9,                  "sreq"},
 {  31,    729,     4,    8,   9, 9, 9, 1,   9,                  "sreq."},

 {  31,    760,     4,   11,   9, 9, 9, 0,   9,                  "srliq"},
 {  31,    760,     4,   11,   9, 9, 9, 1,   9,                  "srliq."},
 {  31,    790,     4,    7,   9, 9, 9, 9,   9,                  "lhbrx"},
 {  31,    792,     4,    8,   9, 9, 9, 0,   9,                  "sra"},
 {  31,    792,     4,    8,   9, 9, 9, 1,   9,                  "sra."},

 {  31,    818,     4,    7,   9, 9, 9, 0,   9,                  "rac"},
 {  31,    818,     4,    7,   9, 9, 9, 1,   9,                  "rac."},
 {  31,    824,     4,   11,   9, 9, 9, 0,   9,                  "srai"},
 {  31,    824,     4,   11,   9, 9, 9, 1,   9,                  "srai."},
 {  31,    918,     4,    7,   9, 9, 9, 9,   9,                  "sthbrx"},

 {  31,    920,     4,    8,   9, 9, 9, 0,   9,                  "sraq"},
 {  31,    920,     4,    8,   9, 9, 9, 1,   9,                  "sraq."},
 {  31,    921,     4,    8,   9, 9, 9, 0,   9,                  "srea"},
 {  31,    921,     4,    8,   9, 9, 9, 1,   9,                  "srea."},
 {  31,    922,     4,    9,   9, 9, 9, 0,   9,                  "exts"},

 {  31,    922,     4,    9,   9, 9, 9, 1,   9,                  "exts."},
 {  31,    952,     4,   11,   9, 9, 9, 0,   9,                  "sraiq"},
 {  31,    952,     4,   11,   9, 9, 9, 1,   9,                  "sraiq."},
 {  31,   1014,     4,    6,   9, 9, 9, 9,   9,                  "dclz"},
 {  31,    535,     4,   12,   9, 9, 9, 9,   9,                  "lfsx"},

 {  32,    999,     0,    2,   9, 9, 9, 9,   9,                  "l"},
 {  33,    999,     0,    2,   9, 9, 9, 9,   9,                  "lu"},
 {  34,    999,     0,    2,   9, 9, 9, 9,   9,                  "lbz"},
 {  35,    999,     0,    2,   9, 9, 9, 9,   9,                  "lbzu"},
 {  36,    999,     0,    2,   9, 9, 9, 9,   9,                  "st"},

 {  37,    999,     0,    2,   9, 9, 9, 9,   9,                  "stu"},
 {  38,    999,     0,    2,   9, 9, 9, 9,   9,                  "stb"},
 {  39,    999,     0,    2,   9, 9, 9, 9,   9,                  "stbu"},
 {  40,    999,     0,    2,   9, 9, 9, 9,   9,                  "lhz"},
 {  41,    999,     0,    2,   9, 9, 9, 9,   9,                  "lhzu"},

 {  42,    999,     0,    2,   9, 9, 9, 9,   9,                  "lha"},
 {  43,    999,     0,    2,   9, 9, 9, 9,   9,                  "lhau"},
 {  44,    999,     0,    2,   9, 9, 9, 9,   9,                  "sth"},
 {  45,    999,     0,    2,   9, 9, 9, 9,   9,                  "sthu"},
 {  46,    999,     0,    2,   9, 9, 9, 9,   9,                  "lm"},

 {  47,    999,     0,    2,   9, 9, 9, 9,   9,                  "stm"},
 {  48,    999,     0,    5,   9, 9, 9, 9,   9,                  "lfs"},
 {  49,    999,     0,    5,   9, 9, 9, 9,   9,                  "lfsu"},
 {  50,    999,     0,    5,   9, 9, 9, 9,   9,                  "lfd"},
 {  51,    999,     0,    5,   9, 9, 9, 9,   9,                  "lfdu"},

 {  52,    999,     0,    5,   9, 9, 9, 9,   9,                  "stfs"},
 {  53,    999,     0,    5,   9, 9, 9, 9,   9,                  "stfsu"},
 {  54,    999,     0,    5,   9, 9, 9, 9,   9,                  "stfd"},
 {  55,    999,     0,    5,   9, 9, 9, 9,   9,                  "stfdu"},
 {  63,      0,     4,   19,   9, 9, 9, 9,   9,                  "fcmpu"},

 {  63,     12,     4,   21,   9, 9, 9, 0,   9,                  "frsp"},
 {  63,     12,     4,   21,   9, 9, 9, 1,   9,                  "frsp."},
 {  63,     18,     9,    0,   9, 9, 9, 0,   9,                  "fd"},
 {  63,     18,     9,    0,   9, 9, 9, 1,   9,                  "fd."},
 {  63,     20,     9,    0,   9, 9, 9, 0,   9,                  "fs"},

 {  63,     20,     9,    0,   9, 9, 9, 1,   9,                  "fs."},
 {  63,     21,     9,    0,   9, 9, 9, 0,   9,                  "fa"},
 {  63,     21,     9,    0,   9, 9, 9, 1,   9,                  "fa."},
 {  63,     25,     9,    1,   9, 9, 9, 0,   9,                  "fm"},
 {  63,     25,     9,    1,   9, 9, 9, 1,   9,                  "fm."},

 {  63,     28,     9,    2,   9, 9, 9, 0,   9,                  "fms"},
 {  63,     28,     9,    2,   9, 9, 9, 1,   9,                  "fms."},
 {  63,     29,     9,    2,   9, 9, 9, 0,   9,                  "fma"},
 {  63,     29,     9,    2,   9, 9, 9, 1,   9,                  "fma."},
 {  63,     30,     9,    2,   9, 9, 9, 0,   9,                  "fnms"},

 {  63,     30,     9,    2,   9, 9, 9, 1,   9,                  "fnms."},
 {  63,     31,     9,    2,   9, 9, 9, 0,   9,                  "fnma"},
 {  63,     31,     9,    2,   9, 9, 9, 1,   9,                  "fnma."},
 {  63,     32,     4,   19,   9, 9, 9, 9,   9,                  "fcmpo"},
 {  63,     38,     4,   16,   9, 9, 9, 0,   9,                  "mtfsb1"},

 {  63,     38,     4,   16,   9, 9, 9, 1,   9,                 "mtfsb1."},
 {  63,     40,     4,   21,   9, 9, 9, 0,   9,                  "fneg"},
 {  63,     40,     4,   21,   9, 9, 9, 1,   9,                  "fneg."},
 {  63,     64,     4,   14,   9, 9, 9, 9,   9,                  "mcrfs"},
 {  63,     70,     4,   16,   9, 9, 9, 0,   9,                  "mtfsb0"},

 {  63,     70,     4,   16,   9, 9, 9, 1,   9,                  "mtfsb0."},
 {  63,     72,     4,   21,   9, 9, 9, 0,   9,                  "fmr"},
 {  63,     72,     4,   21,   9, 9, 9, 1,   9,                  "fmr."},
 {  63,    134,     4,   15,   9, 9, 9, 0,   9,                  "mtfsfi"},
 {  63,    134,     4,   15,   9, 9, 9, 1,   9,                 "mtfsfi."},

 {  63,    136,     4,   21,   9, 9, 9, 0,   9,                  "fnabs"},
 {  63,    136,     4,   21,   9, 9, 9, 1,   9,                  "fnabs."},
 {  63,    264,     4,   21,   9, 9, 9, 0,   9,                  "fabs"},
 {  63,    264,     4,   21,   9, 9, 9, 1,   9,                  "fabs."},
 {  63,    583,     4,   13,   9, 9, 9, 0,   9,                  "mffs"},

 {  63,    583,     4,   13,   9, 9, 9, 1,   9,                  "mffs."},
 {  63,    711,     7,    9,   9, 9, 9, 0,   9,                  "mtfsf"},
 {  63,    711,     7,    9,   9, 9, 9, 1,   9,                  "mtfsf."},
 {  31,    695,     4,   12,   9, 9, 9, 9,   9,                  "stfsux"},
 {  31,    759,     4,   12,   9, 9, 9, 9,   9,                  "stfdux"},

 {  31,    567,     4,   12,   9, 9, 9, 9,   9,                  "lfsux"},
 {  31,    631,     4,   12,   9, 9, 9, 9,   9,                  "lfdux"},


/*     RIOS2 Intructions     */

 {  31,    791,     4,   12,   9, 9, 9, 9,   9,                  "lfqx"},

 {  31,    823,     4,   12,   9, 9, 9, 9,   9,                  "lfqux"},

 {  31,    919,     4,   12,   9, 9, 9, 9,   9,                  "stfqx"},

 {  31,    951,     4,   12,   9, 9, 9, 9,   9,                  "stfqux"},

 {  56,    999,    11,    0,   9, 9, 9, 9,   9,                  "lfq"},

 {  57,    999,    11,    0,   9, 9, 9, 9,   9,                  "lfqu"},

 {  60,    999,    11,    0,   9, 9, 9, 9,   9,                  "stfq"},

 {  61,    999,    11,    0,   9, 9, 9, 9,   9,                  "stfqu"},

 {  63,     14,     4,   21,   9, 9, 9, 0,   9,                  "fcir"},
 {  63,     14,     4,   21,   9, 9, 9, 1,   9,                  "fcir."},

 {  63,     15,     4,   21,   9, 9, 9, 0,   9,                  "fcirz"},
 {  63,     15,     4,   21,   9, 9, 9, 1,   9,                  "fcirz."},

 {  63,     22,     9,    3,   9, 9, 9, 0,   9,                  "fsqrt"},
 {  63,     22,     9,    3,   9, 9, 9, 1,   9,                  "fsqrt."},



 {   0,      0,     0,    0,   0, 0, 0, 0,   0,                       0}
};

search(instr,opcode,exop,format,xformat,AA,LK,SA,RC,OE,retstr,flag)
unsigned long int instr,opcode,*format,*xformat,exop,AA,LK,SA,RC,OE;
char **retstr;
{
char msg[128];
unsigned long int dummy,kind;
register decrec *p;

for(p=dec; p->op; ++p) {
     if(opcode==p->op) { /*for all formats*/
	  if(exop==p->ex) { /*for A format and all X formats*/
	       dummy=((instr>>3)&0x7);
	       if(dummy==2) kind=0;
	       if(dummy!=2) kind=2;
	       if(opcode==19) kind=1;
	       if((exop==144)||(exop==19)) kind=3;
	       switch(kind) {
		    case 0:
			 if(OE==p->O) { /*for XO format*/
			      if(RC==p->R) break;
			      else continue;
			 }
			 else continue;
		    case 1:
			 if(LK==p->L) break; /*for XL format*/
			 else continue;
		    case 2:
			 /* printf("%d\n",kind); for A, X, XFL formats*/
			 if(p->R==9) break;
			 if(RC==p->R) {
			 break;
			 }
			 else continue;
		    case 3:
			 break;   /*for XFX format*/
	       }
	       break;
	  }

	  else if((LK!=9)&&(LK==p->L)&&(opcode!=63)) {/*B,I,and SC formats*/
	       if(AA==p->A) break; /*for B, and I formats*/
	       else if(SA==p->S) break; /*for SC format*/
	       else continue;
	  }

	  else if((LK==9)&&(exop==9999)&&(opcode!=63)) {/*for D,M formats*/
	       if(RC==p->R) break;    /*for M format*/
	       else if(RC==9) break; /*for D format*/
	       else continue;
	  }

	  else continue;
     }

     else continue;
}
*retstr=p->str;
if(*retstr!=0) {
     *format=p->form;
     *xformat=p->xform;
}
else {
     *format=9999;
     *xformat=9999;
}
}

/*
** Functions called from outside this file
**     search_ppc(instr,opcode,exop,format,xformat,AA,LK,SA,RC,OE,retstr)
*/

/*
** search_ppc -- reads instruction table for disassembler information
**
** in:   instr       rt followon machine language instruction
**       opcode      opcode of the instruction
**       exop        extended opcode of the instruction
**       AA          bit used in B and I format instructions
**       LK          bit used in B, I, SC, and XL format instructions
**       SA          bit used in SC format instructions
**       RC          bit used in A,X,XO,XFL, and M format instructions
**       OE          bit used in XO format instructions
**
** out:  format      format of the instruction
**       xformat     print format of the instruction
**       retstr      mneumonic of the instruction
*/
static decrec dec_ppc[] = {

/*******************/
/* format   intger */
/*      D =  0     */
/*      B =  1     */
/*      I =  2     */
/*     SC =  3     */
/*      X =  4     */
/*     XL =  5     */
/*    XFX =  6     */
/*    XFL =  7     */
/*     XO =  8     */
/*      A =  9     */
/*      M = 10     */
/*******************/

/* OPCD    EO     form  xform AA LK SA RC   OE                  retstr */
/* ----    --     ----  ----- -- -- -- --   --                  ------ */
 {  31,    86,      4,    6,   9, 9, 9, 9,   9,                  "dcbf"},
 {  31,   470,      4,    6,   9, 9, 9, 9,   9,                  "dcbi"},
 {  31,    54,      4,    6,   9, 9, 9, 9,   9,                  "dcbst"},
 {  31,   278,      4,    6,   9, 9, 9, 9,   9,                  "dcbt"},
 {  31,   246,      4,    6,   9, 9, 9, 9,   9,                  "dcbtst"},
 {  31,    339,     6,    2,   9, 9, 9, 9,   9,                  "mfspr"},
 {  31,    467,     6,    1,   9, 9, 9, 9,   9,                  "mtspr"},
 {  31,   491,      8,    1,   9, 9, 9, 0,   0,                  "divw"},
 {  31,   491,      8,    1,   9, 9, 9, 1,   0,                  "divw."},
 {  31,   491,      8,    1,   9, 9, 9, 0,   1,                  "divwo"},
 {  31,   491,      8,    1,   9, 9, 9, 1,   1,                  "divwo."},
 {  31,   459,      8,    1,   9, 9, 9, 0,   0,                  "divwu"},
 {  31,   459,      8,    1,   9, 9, 9, 1,   0,                  "divwu."},
 {  31,   459,      8,    1,   9, 9, 9, 0,   1,                  "divwuo"},
 {  31,   459,      8,    1,   9, 9, 9, 1,   1,                  "divwuo."},
 {  31,   310,      4,    7,   9, 9, 9, 9,   9,                  "eciwx"},
 {  31,   438,      4,    7,   9, 9, 9, 9,   9,                  "ecowx"},
 {  31,   854,      4,    1,   9, 9, 9, 9,   9,                  "eieio"},
 {  31,   954,      4,    9,   9, 9, 9, 0,   9,                  "extsb"},
 {  31,   954,      4,    9,   9, 9, 9, 1,   9,                  "extsb."},
 {  59,    21,      9,    0,   9, 9, 9, 0,   9,                  "fadds"},
 {  59,    21,      9,    0,   9, 9, 9, 1,   9,                  "fadds."},
 {  59,    18,      9,    0,   9, 9, 9, 0,   9,                  "fdivs"},
 {  59,    18,      9,    0,   9, 9, 9, 1,   9,                  "fdivs."},
 {  59,    29,      9,    2,   9, 9, 9, 0,   9,                  "fmadds"},
 {  59,    29,      9,    2,   9, 9, 9, 1,   9,                  "fmadds."},
 {  59,    28,      9,    2,   9, 9, 9, 0,   9,                  "fmsubs"},
 {  59,    28,      9,    2,   9, 9, 9, 1,   9,                  "fmsubs."},
 {  59,    25,      9,    1,   9, 9, 9, 0,   9,                  "fmuls"},
 {  59,    25,      9,    1,   9, 9, 9, 1,   9,                  "fmuls."},
 {  59,    31,      9,    2,   9, 9, 9, 0,   9,                  "fnmadds"},
 {  59,    31,      9,    2,   9, 9, 9, 1,   9,                  "fnmadds."},
 {  59,    30,      9,    2,   9, 9, 9, 0,   9,                  "fnmsubs"},
 {  59,    30,      9,    2,   9, 9, 9, 1,   9,                  "fnmsubs."},
 {  59,    24,      9,    3,   9, 9, 9, 0,   9,                  "fres"},
 {  59,    24,      9,    3,   9, 9, 9, 1,   9,                  "fres."},
 {  63,    26,      9,    3,   9, 9, 9, 0,   9,                  "frsqrte"},
 {  63,    26,      9,    3,   9, 9, 9, 1,   9,                  "frsqrte."},
 {  63,    23,      9,    2,   9, 9, 9, 0,   9,                  "fsel"},
 {  63,    23,      9,    2,   9, 9, 9, 1,   9,                  "fsel."},
 {  63,    22,      9,    3,   9, 9, 9, 0,   9,                  "fsqrt"},
 {  63,    22,      9,    3,   9, 9, 9, 1,   9,                  "fsqrt."},
 {  59,    20,      9,    0,   9, 9, 9, 0,   9,                  "fsubs"},
 {  59,    20,      9,    0,   9, 9, 9, 1,   9,                  "fsubs."},
 {  31,   982,      4,    6,   9, 9, 9, 9,   9,                  "icbi"},
 {  31,    20,      4,    7,   9, 9, 9, 9,   9,                  "lwarx"},
 {  31,   371,      6,    3,   9, 9, 9, 9,   9,                  "mftb"},
 {  31,    75,      8,    1,   9, 9, 9, 0,   9,                  "mulhw"},
 {  31,    75,      8,    1,   9, 9, 9, 1,   9,                  "mulhw."},
 {  31,    11,      8,    1,   9, 9, 9, 0,   9,                  "mulhwu"},
 {  31,    11,      8,    1,   9, 9, 9, 1,   9,                  "mulhwu."},
 {  59,     22,     9,    3,   9, 9, 9, 0,   9,                  "fsqrts"},
 {  59,     22,     9,    3,   9, 9, 9, 1,   9,                  "fsqrts."},
 {  31,   983,      4,   12,   9, 9, 9, 9,   9,                  "stfiwx"},
 {  31,   150,      4,    7,   9, 9, 9, 1,   9,                  "stwcx."},
 {  31,    40,      8,    1,   9, 9, 9, 0,   0,                  "subf"},
 {  31,    40,      8,    1,   9, 9, 9, 1,   0,                  "subf."},
 {  31,    40,      8,    1,   9, 9, 9, 0,   1,                  "subfo"},
 {  31,    40,      8,    1,   9, 9, 9, 1,   1,                  "subfo."},
 {  31,   370,      4,    1,   9, 9, 9, 9,   9,                  "tlbia"},
 {  31,   338,      4,   26,   9, 9, 9, 9,   9,                  "tlbiex"},
 {  31,   566,      4,    1,   9, 9, 9, 9,   9,                  "tlbsync"},
 {  31,   659,      4,    4,   9, 9, 9, 9,   9,                  "mfsrin"},
 {  31,   598,      4,    1,   9, 9, 9, 9,   9,                  "sync"},
 {  31,  1014,      4,    6,   9, 9, 9, 9,   9,                  "dcbz"},
 {  17,   999,      3,    1,   9, 9, 9, 9,   9,                  "sc"},
 {  31,   306,      4,   26,   9, 9, 9, 9,   9,                  "tlbie"},
 {   0,      0,     0,    0,   0, 0, 0, 0,   0,                       0}
};

search_ppc(instr,opcode,exop,format,xformat,AA,LK,SA,RC,OE,retstr)
unsigned long int instr,opcode,*format,*xformat,exop,AA,LK,SA,RC,OE;
char **retstr;
{
char msg[128];
unsigned long int dummy,kind;
register decrec *p;

for(p=dec_ppc; p->op; ++p) {
     if((opcode==p->op) && ( (opcode==17)))  /**/
	break;
     if(opcode==p->op)  { /*for all formats*/
	  if(exop==p->ex) { /*for A format and all X formats*/
	       dummy=((instr>>3)&0x7);
	       if(dummy==2) kind=0;
	       if(dummy!=2) kind=2;
	       if(opcode==19) kind=1;
	       if((exop==144)||(exop==19)) kind=3;
	       switch(kind) {
		    case 0:
			 if(OE==p->O) { /*for XO format*/
			      if(RC==p->R) break;
			      else continue;
			 }
			 else continue;
		    case 1:
			 if(LK==p->L) break; /*for XL format*/
			 else continue;
		    case 2:
			 /* printf("%d\n",kind); for A, X, XFL formats*/
			 if(p->R==9) break;
			 if(RC==p->R) {
			 break;
			 }
			 else continue;
		    case 3:
			 break;   /*for XFX format*/
	       }
	       break;
	  }

	  else if((LK!=9)&&(LK==p->L)&&(opcode!=63)) {/*B,I,and SC formats*/
	       if(AA==p->A) break; /*for B, and I formats*/
	       else if(SA==p->S) break; /*for SC format*/
	       else continue;
	  }

	  else if((LK==9)&&(exop==9999)&&(opcode!=63)) {/*for D,M formats*/
	       if(RC==p->R) break;    /*for M format*/
	       else if(RC==9) break; /*for D format*/
	       else continue;
	  }

	  else continue;
     }

     else continue;
}
*retstr=p->str;
if(*retstr!=0) {
     *format=p->form;
     *xformat=p->xform;
}
else {
     *format=9999;
     *xformat=9999;
}
}
